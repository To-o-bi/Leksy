{"version":3,"file":"ProductDetailPage-BiY6DvJS.js","sources":["../../src/components/product/RelatedProducts.jsx","../../src/pages/public/ProductDetailPage.jsx"],"sourcesContent":["import React from 'react';\r\nimport ProductCard from './ProductCard';\r\n\r\nconst RelatedProducts = ({ products }) => {\r\n  if (!products || products.length === 0) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div className=\"mt-16\">\r\n      <h2 className=\"text-2xl font-bold text-gray-800 mb-6\">You May Also Like</h2>\r\n      <div className=\"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6\">\r\n        {products.map((product) => (\r\n          <ProductCard key={product.id} product={product} />\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default RelatedProducts;","import React, { useEffect, useState } from 'react';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport { productService } from '../../api/services';\r\nimport ProductDetail from '../../components/product/ProductDetail';\r\nimport RelatedProducts from '../../components/product/RelatedProducts';\r\nimport Loader from '../../components/common/Loader';\r\n\r\nconst ProductDetailPage = () => {\r\n  const { productId } = useParams();\r\n  const navigate = useNavigate();\r\n  const [loading, setLoading] = useState(true);\r\n  const [product, setProduct] = useState(null);\r\n  const [error, setError] = useState(null);\r\n  const [relatedProducts, setRelatedProducts] = useState([]);\r\n\r\n  useEffect(() => {\r\n    const fetchProductDetails = async () => {\r\n      if (!productId) {\r\n        setError(\"Product ID is missing\");\r\n        setLoading(false);\r\n        return;\r\n      }\r\n\r\n      try {\r\n        setLoading(true);\r\n        setError(null);\r\n        \r\n        const apiResponse = await productService.fetchProduct(productId);\r\n        \r\n        if (!apiResponse || !apiResponse.product) {\r\n          setError(\"Product not found\");\r\n          return;\r\n        }\r\n\r\n        // The product data is already normalized in the ProductDetail component\r\n        // So we just pass the raw API response\r\n        const productData = apiResponse.product;\r\n        setProduct(productData);\r\n        \r\n        // Fetch related products based on category\r\n        try {\r\n          const category = productData.category || productData.category_name;\r\n          if (category && category !== 'Uncategorized') {\r\n            const relatedData = await productService.fetchProducts({\r\n              categories: [category],\r\n              limit: 5\r\n            });\r\n            \r\n            if (relatedData.products) {\r\n              const related = relatedData.products\r\n                .filter(p => {\r\n                  const pId = p.id || p._id || p.product_id;\r\n                  return pId && pId !== productId;\r\n                })\r\n                .slice(0, 4);\r\n                \r\n              setRelatedProducts(related);\r\n            }\r\n          }\r\n        } catch (relatedErr) {\r\n          console.error(\"Error fetching related products:\", relatedErr);\r\n          // Don't fail the whole page if related products fail\r\n          setRelatedProducts([]);\r\n        }\r\n      } catch (err) {\r\n        console.error(\"Error fetching product details:\", err);\r\n        setError(`Failed to load product details: ${err.message}`);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchProductDetails();\r\n  }, [productId]);\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"container mx-auto px-4 py-16\">\r\n        <div className=\"text-center\">\r\n          <Loader />\r\n          <p className=\"mt-4 text-gray-600\">Loading product details...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <div className=\"container mx-auto px-4 py-16 text-center\">\r\n        <h2 className=\"text-2xl font-semibold text-red-600\">{error}</h2>\r\n        <p className=\"mt-2 text-gray-600\">Sorry, we couldn't find the product you're looking for.</p>\r\n        <button \r\n          className=\"mt-6 px-6 py-2 bg-pink-500 text-white rounded-md hover:bg-pink-600 transition-colors\"\r\n          onClick={() => navigate('/shop')}\r\n        >\r\n          Back to Shop\r\n        </button>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50\">\r\n      <div className=\"container mx-auto px-4 py-8\">\r\n        {product && <ProductDetail product={product} />}\r\n        \r\n        {relatedProducts.length > 0 && (\r\n          <div className=\"mt-12\">\r\n            <RelatedProducts products={relatedProducts} />\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ProductDetailPage;"],"names":["RelatedProducts","products","jsxs","jsx","product","ProductCard","ProductDetailPage","productId","useParams","navigate","useNavigate","loading","setLoading","useState","setProduct","error","setError","relatedProducts","setRelatedProducts","useEffect","apiResponse","productService","productData","category","relatedData","related","p","pId","relatedErr","err","Loader","ProductDetail"],"mappings":"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"}
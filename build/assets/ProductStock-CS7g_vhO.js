import{c as V,p as C,j as e,X as W}from"./index-M9bdpqMz.js";import{u as Y,b as r}from"./vendor-Chw79xPl.js";import{P as Z}from"./plus-CRboUGp0.js";import{T}from"./trash-2-DOtf0Zwe.js";import{S as ee}from"./shopping-bag-DxIaoviK.js";import{C as te}from"./chevron-left-Cjdm01Au.js";import{C as se}from"./chevron-right-BpsnKVUa.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],le=V("square-pen",ae),xe=()=>{const f=Y(),[i,y]=r.useState([]),[z,D]=r.useState(!0),[x,_]=r.useState(1),[b,d]=r.useState(null),[q,j]=r.useState(!1),[o,M]=r.useState(null),[N,E]=r.useState(!1),[n,F]=r.useState(!1),[l,u]=r.useState(new Set),[R,v]=r.useState(!1),[w,I]=r.useState(!1),h=10;r.useEffect(()=>{H()},[]);const H=async()=>{try{D(!0);const t=await C.fetchProducts();if(t&&t.code===200)y(t.products||[]);else throw new Error((t==null?void 0:t.message)||"Failed to fetch products")}catch(t){console.error("Error fetching products:",t),d({type:"error",message:t.message||"Failed to load products"})}finally{D(!1)}},U=async()=>{if(o){E(!0);try{const t=await C.deleteProduct(o.product_id);if(t&&t.code===200)y(s=>s.filter(c=>c.product_id!==o.product_id)),d({type:"success",message:`Product "${o.name}" deleted successfully`}),j(!1),M(null);else throw new Error((t==null?void 0:t.message)||"Failed to delete product")}catch(t){d({type:"error",message:t.message||"Failed to delete product"})}finally{E(!1)}}},$=()=>{F(!n),u(new Set)},X=t=>{const s=new Set(l);s.has(t)?s.delete(t):s.add(t),u(s)},G=()=>{const t=S.map(a=>a.product_id),s=t.every(a=>l.has(a)),c=new Set(l);s?t.forEach(a=>c.delete(a)):t.forEach(a=>c.add(a)),u(c)},J=async()=>{if(l.size===0)return;I(!0);const t=Array.from(l);i.filter(s=>l.has(s.product_id)).map(s=>s.name);try{const s=t.map(m=>C.deleteProduct(m)),c=await Promise.allSettled(s),a=[],k=[];c.forEach((m,P)=>{var L;const B=t[P];m.status==="fulfilled"&&((L=m.value)==null?void 0:L.code)===200?a.push(B):k.push(B)}),a.length>0&&y(m=>m.filter(P=>!a.includes(P.product_id))),k.length===0?d({type:"success",message:`Successfully deleted ${a.length} product${a.length>1?"s":""}`}):a.length===0?d({type:"error",message:"Failed to delete selected products"}):d({type:"success",message:`Deleted ${a.length} products. ${k.length} failed to delete.`}),u(new Set),v(!1),F(!1)}catch{d({type:"error",message:"An error occurred during bulk deletion"})}finally{I(!1)}},K=t=>t?"₦"+parseFloat(t).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):"₦0.00",O=t=>{const s=parseInt(t)||0;return s===0?"bg-red-100 text-red-800":s<=10?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"},g=Math.ceil(i.length/h),p=(x-1)*h,S=i.slice(p,p+h),A=S.map(t=>t.product_id),Q=A.length>0&&A.every(t=>l.has(t));return e.jsxs("div",{className:"bg-gray-50 min-h-screen p-6",children:[b&&e.jsx("div",{className:`fixed top-4 right-4 p-4 rounded-md shadow-md z-50 ${b.type==="success"?"bg-green-50 text-green-800":"bg-red-50 text-red-800"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:b.message}),e.jsx("button",{onClick:()=>d(null),className:"ml-4 text-gray-400",children:"×"})]})}),e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-medium text-gray-800",children:"Product Stock"}),e.jsx("div",{className:"flex items-center space-x-3",children:n?e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"text-sm text-gray-600",children:[l.size," selected"]}),l.size>0&&e.jsxs("button",{onClick:()=>v(!0),className:"bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-md flex items-center",children:[e.jsx(T,{size:16,className:"mr-2"}),"Delete Selected"]}),e.jsxs("button",{onClick:$,className:"bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-md flex items-center",children:[e.jsx(W,{size:16,className:"mr-2"}),"Cancel"]})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:$,className:"bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-md flex items-center",children:"Select Products"}),e.jsxs("button",{onClick:()=>f("/admin/products/add"),className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-md flex items-center",children:[e.jsx(Z,{size:16,className:"mr-2"}),"Add New"]})]})})]}),e.jsxs("div",{className:"bg-white rounded-md shadow-sm overflow-hidden",children:[e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[n&&e.jsx("th",{className:"px-4 py-3 text-left",children:e.jsx("input",{type:"checkbox",checked:Q,onChange:G,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"})}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-500",children:"Image"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-500",children:"Product"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-500",children:"Category"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-500",children:"Price"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-500",children:"Stock"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-500",children:"Actions"})]})}),e.jsx("tbody",{children:z?e.jsx("tr",{children:e.jsxs("td",{colSpan:n?"7":"6",className:"px-4 py-8 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto"}),e.jsx("p",{className:"text-gray-500 mt-2",children:"Loading products..."})]})}):i.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:n?"7":"6",className:"px-4 py-8 text-center",children:[e.jsx(ee,{size:48,className:"text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"No products found"}),e.jsx("button",{onClick:()=>f("/admin/products/add"),className:"text-blue-500 hover:underline mt-2",children:"Add your first product"})]})}):S.map(t=>{var s;return e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[n&&e.jsx("td",{className:"px-4 py-3",children:e.jsx("input",{type:"checkbox",checked:l.has(t.product_id),onChange:()=>X(t.product_id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"w-12 h-12 rounded-md overflow-hidden bg-gray-100",children:e.jsx("img",{src:((s=t.images)==null?void 0:s[0])||"/placeholder.jpg",alt:t.name,className:"w-full h-full object-cover",onError:c=>c.target.src="/placeholder.jpg"})})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"font-medium text-gray-900",children:t.name})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"text-gray-600 capitalize",children:t.category})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"font-medium",children:K(t.price)})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${O(t.available_qty)}`,children:t.available_qty||0})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:()=>f(`/admin/products/edit/${t.product_id}`),className:"text-gray-500 hover:text-gray-700",disabled:n,children:e.jsx(le,{size:16})}),e.jsx("button",{onClick:()=>{M(t),j(!0)},className:"text-gray-500 hover:text-red-500",disabled:n,children:e.jsx(T,{size:16})})]})})]},t.product_id)})})]}),!z&&i.length>0&&g>1&&e.jsxs("div",{className:"px-4 py-4 flex justify-between items-center border-t",children:[e.jsxs("p",{className:"text-sm text-gray-500",children:["Showing ",p+1,"-",Math.min(p+h,i.length)," of ",i.length]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>_(t=>Math.max(1,t-1)),disabled:x===1,className:"p-2 rounded-md text-gray-500 hover:bg-gray-100 disabled:opacity-50",children:e.jsx(te,{size:20})}),e.jsxs("span",{className:"text-sm",children:["Page ",x," of ",g]}),e.jsx("button",{onClick:()=>_(t=>Math.min(g,t+1)),disabled:x===g,className:"p-2 rounded-md text-gray-500 hover:bg-gray-100 disabled:opacity-50",children:e.jsx(se,{size:20})})]})]})]}),q&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Confirm Delete"}),e.jsxs("p",{className:"text-gray-600 mb-6",children:['Are you sure you want to delete "',o==null?void 0:o.name,'"? This action cannot be undone.']}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>j(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",disabled:N,children:"Cancel"}),e.jsx("button",{onClick:U,className:"px-4 py-2 bg-red-500 text-white rounded-md hover:bg-red-600 disabled:opacity-50",disabled:N,children:N?"Deleting...":"Delete"})]})]})}),R&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Confirm Bulk Delete"}),e.jsxs("p",{className:"text-gray-600 mb-6",children:["Are you sure you want to delete ",l.size," selected product",l.size>1?"s":"","? This action cannot be undone."]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>v(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",disabled:w,children:"Cancel"}),e.jsx("button",{onClick:J,className:"px-4 py-2 bg-red-500 text-white rounded-md hover:bg-red-600 disabled:opacity-50",disabled:w,children:w?"Deleting...":`Delete ${l.size} Product${l.size>1?"s":""}`})]})]})})]})};export{xe as default};
//# sourceMappingURL=ProductStock-CS7g_vhO.js.map

import{c as F,j as e,C as se,g as te,h as z}from"./index-M9bdpqMz.js";import{b as r}from"./vendor-Chw79xPl.js";import{R as ae}from"./refresh-cw-D7OP5od0.js";import{S as ne}from"./search-1ZtBFY2y.js";import{E as le}from"./eye-C17Yuevi.js";import{M as ie}from"./mail-D4TXmlJc.js";import{C as re}from"./calendar-DQUy51DF.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]],de=F("phone",ce);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],me=F("user",oe),be=()=>{const[x,j]=r.useState([]),[u,q]=r.useState([]),[g,S]=r.useState(!0),[p,C]=r.useState(null),[o,b]=r.useState(1),[d,O]=r.useState("all"),[y,G]=r.useState(""),[a,P]=r.useState(null),[H,N]=r.useState(!1),[h,m]=r.useState(null),[V,_]=r.useState(!1),v=10,A=s=>{if(!s)return"Unknown";try{return new Date(s).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})}catch{return"Invalid Date"}},D=s=>s||"Time not specified",T=s=>({completed:"bg-green-100 text-green-600","in-session":"bg-blue-100 text-blue-600",unheld:"bg-yellow-100 text-yellow-600",cancelled:"bg-red-100 text-red-600"})[s==null?void 0:s.toLowerCase()]||"bg-gray-100 text-gray-600",E=s=>({successful:"bg-green-100 text-green-600",unsuccessful:"bg-red-100 text-red-600"})[s==null?void 0:s.toLowerCase()]||"bg-gray-100 text-gray-600",B=s=>s?new Intl.NumberFormat("en-NG",{style:"currency",currency:"NGN",minimumFractionDigits:0,maximumFractionDigits:0}).format(s):"â‚¦0",w=async()=>{var s,l,i;try{if(S(!0),C(null),!z.getToken())throw new Error("Admin authentication required. Please log in as admin.");const c=await z.get("admin/fetch-consultations",{limit:100});if(((s=c.data)==null?void 0:s.code)===200){const{coming_consultations:X=[],past_consultations:Z=[]}=c.data,ee=[...X,...Z].map(n=>{var I,U;const $=((I=n.name)==null?void 0:I.split(" "))||["Unknown"];return{id:n.consultation_id||n.unique_id,uniqueId:n.unique_id,firstName:$[0],lastName:$.slice(1).join(" "),fullName:n.name||"Unknown Customer",email:n.email||"",phone:n.phone||"",ageRange:n.age_range||"",gender:n.gender||"",skinType:n.skin_type||"",skinConcerns:n.skin_concerns||"",currentProducts:n.current_skincare_products||"",additionalDetails:n.additional_details||"",channel:n.channel||"",consultationDate:n.date||"",timeRange:n.time_range||"",sessionStatus:n.session_held_status||"unheld",paymentStatus:((U=n.payment_status)==null?void 0:U.toLowerCase())||"unsuccessful",amountPaid:n.amount_paid||0,amountCalculated:n.amount_calculated||0,createdAt:n.created_at||"",apiRef:n.api_ref||"",rawData:n}});j(ee)}else throw new Error(((l=c.data)==null?void 0:l.message)||"Failed to fetch consultation bookings")}catch(t){console.error("Error fetching bookings:",t);let c="Failed to load consultation bookings";((i=t.response)==null?void 0:i.status)===401||t.message.includes("Unauthorized")||t.message.includes("authentication")||t.message.includes("Admin")||t.isAPILevel401?c="Admin authentication required. Please ensure you are logged in as an admin to view consultation bookings.":t.message&&(c=t.message),C(c)}finally{S(!1)}},Y=()=>{let s=[...x];if(d!=="all"){const l={upcoming:t=>t.sessionStatus==="unheld"&&t.paymentStatus==="successful",paid:t=>t.paymentStatus==="successful",unpaid:t=>t.paymentStatus==="unsuccessful",default:t=>t.sessionStatus===d},i=l[d]||l.default;s=s.filter(i)}if(y.trim()){const l=y.toLowerCase();s=s.filter(i=>[i.id,i.fullName,i.email,i.phone,i.skinConcerns].some(t=>t==null?void 0:t.toLowerCase().includes(l)))}q(s)},L=async(s,l)=>{try{_(!0);const i=t=>t.id===s?{...t,sessionStatus:l}:t;j(t=>t.map(i)),(a==null?void 0:a.id)===s&&P({...a,sessionStatus:l}),m({type:"success",message:`Session status updated to "${l}"`})}catch(i){console.error("Error updating session status:",i),m({type:"error",message:"Failed to update session status"}),j(t=>t.map(c=>c.id===s?{...c,sessionStatus:c.sessionStatus}:c))}finally{_(!1)}},J=s=>{P(s),N(!0)},K=s=>{m({type:"success",message:`Meeting link sent to ${s}`})},Q=s=>{m({type:"success",message:`Reminder sent to ${s}`})};r.useEffect(()=>{if(h){const s=setTimeout(()=>m(null),5e3);return()=>clearTimeout(s)}},[h]),r.useEffect(()=>{w()},[]),r.useEffect(()=>{Y()},[x,d,y]);const f=Math.ceil(u.length/v),k=o*v,M=k-v,R=u.slice(M,k),W=[{key:"all",label:"All"},{key:"upcoming",label:"Upcoming"},{key:"paid",label:"Paid"},{key:"unpaid",label:"Unpaid"},{key:"completed",label:"Completed"},{key:"in-session",label:"In Session"},{key:"unheld",label:"Unheld"}];if(g&&x.length===0)return e.jsx("div",{className:"bg-white rounded-lg p-6 shadow-sm",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-48 mb-6"}),e.jsx("div",{className:"space-y-4",children:Array.from({length:5},(s,l)=>e.jsx("div",{className:"h-12 bg-gray-200 rounded w-full"},l))})]})});if(p&&x.length===0){const s=p.includes("authentication")||p.includes("Admin");return e.jsx("div",{className:"bg-white rounded-lg p-6 shadow-sm",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(se,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:s?"Authentication Required":"Error Loading Bookings"}),e.jsx("p",{className:"text-gray-600 mb-4",children:p}),e.jsx("button",{onClick:s?()=>window.location.href="/admin/login":w,className:"bg-pink-500 text-white px-6 py-2 rounded-md hover:bg-pink-600",children:s?"Go to Login":"Try Again"})]})})}return e.jsxs("div",{className:"space-y-6",children:[h&&e.jsx("div",{className:`fixed top-4 right-4 p-4 rounded-md shadow-lg z-50 ${h.type==="success"?"bg-green-50 text-green-800 border border-green-200":"bg-red-50 text-red-800 border border-red-200"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:h.message}),e.jsx("button",{onClick:()=>m(null),className:"ml-4 text-xl",children:"Ã—"})]})}),e.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-800",children:"Consultation Bookings"}),e.jsx("p",{className:"text-gray-600 mt-1",children:g?"Loading...":`${u.length} of ${x.length} consultations`})]}),e.jsxs("button",{onClick:w,className:"bg-pink-500 hover:bg-pink-600 text-white px-4 py-2 rounded-md flex items-center",disabled:g,children:[e.jsx(ae,{className:`h-4 w-4 mr-2 ${g?"animate-spin":""}`}),"Refresh"]})]}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ne,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search consultations by ID, name, email, phone, or skin concerns...",value:y,onChange:s=>G(s.target.value),className:"pl-10 pr-4 py-2 w-full border border-gray-200 rounded-md focus:ring-2 focus:ring-pink-500 focus:border-pink-500"})]}),e.jsx("div",{className:"flex space-x-2 overflow-x-auto",children:W.map(s=>e.jsx("button",{className:`px-4 py-2 text-sm rounded-md whitespace-nowrap ${d===s.key?"bg-pink-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,onClick:()=>{O(s.key),b(1)},children:s.label},s.key))})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsx("tr",{className:"border-b border-gray-200",children:["ID","CUSTOMER","CONSULTATION","PAYMENT","SESSION","ACTION"].map(s=>e.jsx("th",{className:"pb-3 text-sm font-medium text-gray-500 uppercase",children:s},s))})}),e.jsx("tbody",{children:R.length>0?R.map(s=>e.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[e.jsx("td",{className:"py-4 text-sm font-mono",children:s.id}),e.jsx("td",{className:"py-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:s.fullName}),e.jsx("div",{className:"text-xs text-gray-500",children:s.email}),e.jsx("div",{className:"text-xs text-gray-500",children:s.phone})]})}),e.jsx("td",{className:"py-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:A(s.consultationDate)}),e.jsx("div",{className:"text-xs text-gray-500",children:D(s.timeRange)}),e.jsx("div",{className:"text-xs text-gray-500 capitalize",children:s.channel})]})}),e.jsx("td",{className:"py-4",children:e.jsxs("div",{children:[e.jsx("span",{className:`text-xs px-2 py-1 rounded-full font-medium ${E(s.paymentStatus)}`,children:s.paymentStatus}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:B(s.amountPaid)})]})}),e.jsx("td",{className:"py-4",children:e.jsxs("select",{value:s.sessionStatus,onChange:l=>L(s.id,l.target.value),disabled:V,className:`text-xs px-2 py-1 rounded-full border-0 cursor-pointer font-medium ${T(s.sessionStatus)}`,children:[e.jsx("option",{value:"unheld",children:"Unheld"}),e.jsx("option",{value:"in-session",children:"In Session"}),e.jsx("option",{value:"completed",children:"Completed"})]})}),e.jsx("td",{className:"py-4",children:e.jsxs("button",{className:"text-pink-500 border border-pink-500 rounded-lg px-4 py-2 text-sm hover:bg-pink-50 flex items-center",onClick:()=>J(s),children:[e.jsx(le,{className:"h-4 w-4 mr-1"}),"View Details"]})})]},s.id)):e.jsx("tr",{children:e.jsxs("td",{colSpan:"6",className:"py-12 text-center text-gray-500",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ“…"}),e.jsx("p",{className:"text-lg font-medium",children:"No consultation bookings found"}),e.jsx("p",{className:"text-sm mt-1",children:d!=="all"?`No ${d} consultations`:"No consultation bookings yet"})]})})})]})}),f>1&&e.jsxs("div",{className:"mt-6 flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Showing ",M+1,"-",Math.min(k,u.length)," of ",u.length," consultations"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>b(Math.max(1,o-1)),disabled:o===1,className:"h-8 w-8 flex justify-center items-center rounded border border-gray-200 disabled:opacity-50",children:"â€¹"}),e.jsxs("span",{className:"text-sm px-2",children:["Page ",o," of ",f]}),e.jsx("button",{onClick:()=>b(Math.min(f,o+1)),disabled:o===f,className:"h-8 w-8 flex justify-center items-center rounded border border-gray-200 disabled:opacity-50",children:"â€º"})]})]})]}),H&&a&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsxs("h3",{className:"text-xl font-semibold",children:["Consultation Details - ",a.id]}),e.jsx("button",{onClick:()=>N(!1),className:"text-gray-400 hover:text-gray-600",children:"âœ•"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold text-gray-900 border-b pb-2 mb-4 flex items-center",children:[e.jsx(me,{className:"h-5 w-5 mr-2"}),"Customer Information"]}),e.jsx("div",{className:"space-y-3",children:[{label:"Full Name",value:a.fullName},{label:"Email",value:a.email,icon:ie},{label:"Phone",value:a.phone,icon:de},{label:"Age Range",value:a.ageRange},{label:"Gender",value:a.gender,capitalize:!0}].map(({label:s,value:l,icon:i,capitalize:t})=>e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:s}),e.jsxs("div",{className:"flex items-center",children:[i&&e.jsx(i,{className:"h-4 w-4 mr-2 text-gray-400"}),e.jsx("p",{className:`text-gray-900 ${t?"capitalize":""}`,children:l})]})]},s))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 border-b pb-2 mb-4",children:"Skin Information"}),e.jsx("div",{className:"space-y-3",children:[{label:"Skin Type",value:a.skinType,capitalize:!0},{label:"Skin Concerns",value:a.skinConcerns},{label:"Current Products",value:a.currentProducts||"Not specified"}].map(({label:s,value:l,capitalize:i})=>e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:s}),e.jsx("p",{className:`text-gray-900 ${i?"capitalize":""}`,children:l})]},s))})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold text-gray-900 border-b pb-2 mb-4 flex items-center",children:[e.jsx(re,{className:"h-5 w-5 mr-2"}),"Consultation Details"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Date"}),e.jsx("p",{className:"text-gray-900",children:A(a.consultationDate)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Time"}),e.jsx("p",{className:"text-gray-900",children:D(a.timeRange)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Channel"}),e.jsx("p",{className:"text-gray-900 capitalize",children:a.channel})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Session Status"}),e.jsx("span",{className:`inline-block text-xs px-3 py-1 rounded-full font-medium ${T(a.sessionStatus)}`,children:a.sessionStatus})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Payment Status"}),e.jsx("span",{className:`inline-block text-xs px-3 py-1 rounded-full font-medium ${E(a.paymentStatus)}`,children:a.paymentStatus})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Amount"}),e.jsx("p",{className:"text-gray-900",children:B(a.amountPaid)})]})]})]}),a.additionalDetails&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 border-b pb-2 mb-4",children:"Additional Details"}),e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:e.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:a.additionalDetails})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 border-b pb-2 mb-4",children:"Actions"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:()=>K(a.email),className:"w-full px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 text-sm",children:"Send Meeting Link"}),e.jsx("button",{onClick:()=>Q(a.email),className:"w-full px-4 py-2 bg-orange-500 text-white rounded-md hover:bg-orange-600 text-sm",children:"Send Reminder"}),e.jsxs("button",{onClick:()=>L(a.id,"completed"),className:"w-full px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600 text-sm flex items-center justify-center",children:[e.jsx(te,{className:"h-4 w-4 mr-2"}),"Mark as Completed"]})]})]})]})]}),e.jsx("div",{className:"mt-8 flex justify-end space-x-3 pt-4 border-t",children:e.jsx("button",{onClick:()=>N(!1),className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200",children:"Close"})})]})})]})};export{be as default};
//# sourceMappingURL=BookingsPage-CwEOMyww.js.map

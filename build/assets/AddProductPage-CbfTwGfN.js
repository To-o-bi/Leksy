import{c as O,j as e,g as E,C as o,X as C,p as L}from"./index-M9bdpqMz.js";import{b as u,u as R,f as T}from"./vendor-Chw79xPl.js";import{C as W}from"./chevron-left-Cjdm01Au.js";import{P as Q}from"./plus-CRboUGp0.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],H=O("image",U),J=()=>{const b=u.useRef(null),[r,x]=u.useState({name:"",price:"",slashed_price:"",category:"",quantity:"",description:"",concern_options:[],images:[]}),[i,h]=u.useState({}),[n,y]=u.useState(!1),[d,v]=u.useState([]),[_,f]=u.useState(!1),[g,c]=u.useState(null),q=[{value:"serums",label:"Serums"},{value:"face cleansers",label:"Face Cleansers"},{value:"sunscreens",label:"Sunscreens"},{value:"moisturizers",label:"Moisturizers"},{value:"bathe and body",label:"Bathe and Body"},{value:"toners",label:"Toners"}],P=[{value:"anti_aging",label:"Anti-Aging"},{value:"oily_skin",label:"Oily Skin"},{value:"dry_skin",label:"Dry Skin"},{value:"acne",label:"Acne"},{value:"hyperpigmentation",label:"Hyperpigmentation"},{value:"sensitive_skin",label:"Sensitive Skin"}],p=s=>{const{name:a,value:t}=s.target;x({...r,[a]:t}),i[a]&&h({...i,[a]:null})},z=s=>{const a=r.concern_options.includes(s)?r.concern_options.filter(t=>t!==s):[...r.concern_options,s];x({...r,concern_options:a}),i.concern_options&&h({...i,concern_options:null})},S=()=>{const s={};return r.name.trim()||(s.name="Product name is required"),r.price||(s.price="Price is required"),r.price<=0&&(s.price="Price must be greater than 0"),r.category||(s.category="Category is required"),r.quantity||(s.quantity="Quantity is required"),r.quantity<0&&(s.quantity="Quantity must be 0 or greater"),r.description.trim()||(s.description="Description is required"),r.concern_options.length===0&&(s.concern_options="At least one skin concern is required"),r.images.length===0&&(s.images="At least one product image is required"),r.slashed_price&&Number(r.slashed_price)<=Number(r.price)&&(s.slashed_price="Original price should be greater than current price"),h(s),Object.keys(s).length===0},I=async s=>{if(s.preventDefault(),!S()){c({type:"error",message:"Please correct the errors above and try again."});return}y(!0),c(null);try{const a={name:r.name.trim(),price:parseFloat(r.price),description:r.description.trim(),quantity:parseInt(r.quantity,10),category:r.category,concern_options:r.concern_options,images:r.images};r.slashed_price&&(a.slashed_price=parseFloat(r.slashed_price)),console.log("Submitting product via productService...",{...a,images:`${a.images.length} files`});const t=await L.addProduct(a);if(console.log("Product added successfully:",t),t&&t.code===200)c({type:"success",message:`Product "${r.name}" has been added successfully!`}),setTimeout(()=>{w("/admin/products/stock")},2e3);else throw new Error((t==null?void 0:t.message)||"Failed to add product")}catch(a){console.error("Error adding product:",a);let t="Failed to add product. Please try again.";a.message.includes("name is required")?t="Product name is required.":a.message.includes("price is required")?t="Valid price is required.":a.message.includes("description is required")?t="Description is required.":a.message.includes("quantity is required")?t="Valid quantity is required.":a.message.includes("category is required")?t="Valid category is required.":a.message.includes("concern option")?t="At least one skin concern is required.":a.message.includes("Only image files allowed")?t="Only image files are allowed.":a.message.includes("Image must be less than 2MB")?t="Images must be less than 2MB each.":a.message.includes("Authentication")||a.message.includes("Unauthorized")?t="Please log in again to continue.":a.message&&(t=a.message),c({type:"error",message:t})}finally{y(!1)}},A=s=>{const a=s.target.files;j(a)},j=s=>{if(d.length+s.length>5){c({type:"error",message:"Maximum 5 images allowed per product"});return}const t=[...d],m=[...r.images];Array.from(s).forEach(l=>{if(!l.type.startsWith("image/")){c({type:"error",message:"Only image files are allowed"});return}if(l.size>2*1024*1024){c({type:"error",message:`File ${l.name} is too large. Maximum size is 2MB`});return}const k=new FileReader;k.onload=M=>{t.push({url:M.target.result,file:l}),v([...t])},k.readAsDataURL(l),m.push(l)}),x({...r,images:m}),i.images&&m.length>0&&h({...i,images:null})},N=s=>{const a=[...d],t=[...r.images];a.splice(s,1),t.splice(s,1),v(a),x({...r,images:t})},D=s=>{s.preventDefault(),f(!0)},$=()=>{f(!1)},B=s=>{s.preventDefault(),f(!1),s.dataTransfer.files&&j(s.dataTransfer.files)},w=R(),F=()=>{Object.values(r).some(a=>typeof a=="string"?a.trim()!=="":Array.isArray(a)?a.length>0:!1)&&!window.confirm("You have unsaved changes. Are you sure you want to leave?")||(w("/admin/products"),console.log("Would navigate back to products list..."))};return T.useEffect(()=>{if(g){const s=setTimeout(()=>{c(null)},5e3);return()=>clearTimeout(s)}},[g]),e.jsxs("div",{className:"bg-gray-50 min-h-screen p-4 sm:p-6 md:p-8",children:[g&&e.jsx("div",{className:`fixed top-4 right-4 p-4 rounded-md shadow-lg z-50 max-w-md ${g.type==="success"?"bg-green-50 text-green-800 border border-green-200":"bg-red-50 text-red-800 border border-red-200"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[g.type==="success"?e.jsx(E,{size:20,className:"mr-2 flex-shrink-0"}):e.jsx(o,{size:20,className:"mr-2 flex-shrink-0"}),e.jsx("span",{children:g.message})]}),e.jsx("button",{onClick:()=>c(null),className:"ml-4 text-xl font-bold hover:opacity-70",children:"×"})]})}),e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("button",{onClick:F,className:"flex items-center text-gray-600 hover:text-pink-500 transition-colors",disabled:n,children:[e.jsx(W,{size:20}),e.jsx("span",{className:"ml-1",children:"Back to Products"})]})}),e.jsx("h1",{className:"text-2xl font-medium mb-6 md:mb-8",children:"Add New Product"}),e.jsx("div",{className:"bg-white rounded-lg p-4 sm:p-6 md:p-8 shadow-sm",children:e.jsxs("div",{className:"flex flex-col md:flex-row",children:[e.jsxs("div",{className:"w-full md:w-1/3 md:mr-8 mb-6 md:mb-0",children:[e.jsxs("div",{className:`${_?"border-pink-500 bg-pink-50":i.images?"border-red-500 bg-red-50":"border-gray-300 bg-gray-100"} border-2 border-dashed h-64 rounded-lg flex items-center justify-center mb-4 transition-all cursor-pointer`,onClick:()=>{var s;return(s=b.current)==null?void 0:s.click()},onDragOver:D,onDragLeave:$,onDrop:B,children:[d.length===0?e.jsxs("div",{className:"text-center p-4",children:[e.jsx("div",{className:"mx-auto bg-white p-4 rounded-full mb-2 inline-flex",children:e.jsx(H,{size:24,className:"text-gray-400"})}),e.jsx("p",{className:"text-gray-500 mb-2",children:"Drag and drop images here or click to browse"}),e.jsx("button",{type:"button",className:"bg-gray-200 hover:bg-gray-300 text-gray-700 py-2 px-4 rounded-md text-sm",disabled:n,children:"Add Image"}),e.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"Max 5 images, 2MB each"})]}):e.jsxs("div",{className:"relative w-full h-full",children:[e.jsx("img",{src:d[0].url,alt:"Product preview",className:"h-full w-full object-contain rounded-lg"}),!n&&e.jsx("button",{type:"button",onClick:s=>{s.stopPropagation(),N(0)},className:"absolute top-2 right-2 bg-gray-800 bg-opacity-70 text-white p-1 rounded-full hover:bg-opacity-100",children:e.jsx(C,{size:16})})]}),e.jsx("input",{type:"file",ref:b,onChange:A,multiple:!0,accept:"image/*",className:"hidden",disabled:n})]}),i.images&&e.jsxs("p",{className:"mb-4 text-red-500 text-sm flex items-center",children:[e.jsx(o,{size:16,className:"mr-1"}),i.images]}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:[...Array(4)].map((s,a)=>{const t=a+1,m=d.length>t;return e.jsx("div",{className:`h-20 w-full bg-gray-100 rounded-md relative ${m?"":"flex items-center justify-center border border-gray-300 cursor-pointer"}`,onClick:()=>{var l;return!m&&!n&&((l=b.current)==null?void 0:l.click())},children:m?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:d[t].url,alt:`Product thumbnail ${t}`,className:"h-full w-full object-cover rounded-md"}),!n&&e.jsx("button",{type:"button",onClick:l=>{l.stopPropagation(),N(t)},className:"absolute top-1 right-1 bg-gray-800 bg-opacity-70 text-white p-1 rounded-full hover:bg-opacity-100",children:e.jsx(C,{size:12})})]}):e.jsx(Q,{size:20,className:"text-gray-400"})},a)})})]}),e.jsxs("div",{className:"w-full md:w-2/3",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-gray-700 mb-2",children:"Product Name*"}),e.jsx("input",{type:"text",name:"name",value:r.name,onChange:p,disabled:n,className:`w-full border ${i.name?"border-red-500":"border-gray-300"} rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-pink-500`,placeholder:"Enter product name"}),i.name&&e.jsxs("p",{className:"mt-1 text-red-500 text-sm flex items-center",children:[e.jsx(o,{size:16,className:"mr-1"}),i.name]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 sm:gap-6 mb-6",children:[e.jsxs("div",{className:"w-full sm:w-1/2",children:[e.jsx("label",{className:"block text-gray-700 mb-2",children:"Current Price*"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-4 pointer-events-none",children:e.jsx("span",{className:"text-gray-700 font-bold",children:"₦"})}),e.jsx("input",{type:"number",name:"price",value:r.price,onChange:p,disabled:n,min:"0",step:"0.01",className:`w-full border ${i.price?"border-red-500":"border-gray-300"} rounded-lg pl-10 pr-4 py-3 focus:outline-none focus:ring-2 focus:ring-pink-500`,placeholder:"0.00"})]}),i.price&&e.jsxs("p",{className:"mt-1 text-red-500 text-sm flex items-center",children:[e.jsx(o,{size:16,className:"mr-1"}),i.price]})]}),e.jsxs("div",{className:"w-full sm:w-1/2",children:[e.jsx("label",{className:"block text-gray-700 mb-2",children:"Slashed Price (Optional)"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-4 pointer-events-none",children:e.jsx("span",{className:"text-gray-700 font-bold",children:"₦"})}),e.jsx("input",{type:"number",name:"slashed_price",value:r.slashed_price,onChange:p,disabled:n,min:"0",step:"0.01",className:`w-full border ${i.slashed_price?"border-red-500":"border-gray-300"} rounded-lg pl-10 pr-4 py-3 focus:outline-none focus:ring-2 focus:ring-pink-500`,placeholder:"0.00"})]}),i.slashed_price&&e.jsxs("p",{className:"mt-1 text-red-500 text-sm flex items-center",children:[e.jsx(o,{size:16,className:"mr-1"}),i.slashed_price]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-gray-700 mb-2",children:"Category*"}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{name:"category",value:r.category,onChange:p,disabled:n,className:`w-full border ${i.category?"border-red-500":"border-gray-300"} rounded-lg px-4 py-3 appearance-none focus:outline-none focus:ring-2 focus:ring-pink-500`,children:[e.jsx("option",{value:"",children:"Select Category"}),q.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))]}),e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-4 pointer-events-none",children:e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("polyline",{points:"6 9 12 15 18 9"})})})]}),i.category&&e.jsxs("p",{className:"mt-1 text-red-500 text-sm flex items-center",children:[e.jsx(o,{size:16,className:"mr-1"}),i.category]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-gray-700 mb-2",children:"Available Quantity*"}),e.jsx("input",{type:"number",name:"quantity",value:r.quantity,onChange:p,disabled:n,min:"0",className:`w-full border ${i.quantity?"border-red-500":"border-gray-300"} rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-pink-500`,placeholder:"Enter quantity"}),i.quantity&&e.jsxs("p",{className:"mt-1 text-red-500 text-sm flex items-center",children:[e.jsx(o,{size:16,className:"mr-1"}),i.quantity]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-gray-700 mb-2",children:"Skin Concerns*"}),e.jsx("p",{className:"text-sm text-gray-500 mb-3",children:"Select which skin concerns this product addresses:"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:P.map(s=>e.jsxs("label",{className:`flex items-center p-3 rounded-lg border cursor-pointer transition-colors ${r.concern_options.includes(s.value)?"bg-pink-50 border-pink-300 text-pink-700":"bg-white border-gray-200 hover:bg-gray-50"} ${n?"opacity-50 cursor-not-allowed":""}`,children:[e.jsx("input",{type:"checkbox",checked:r.concern_options.includes(s.value),onChange:()=>z(s.value),disabled:n,className:"sr-only"}),e.jsx("div",{className:`w-4 h-4 rounded border-2 mr-3 flex items-center justify-center flex-shrink-0 ${r.concern_options.includes(s.value)?"bg-pink-500 border-pink-500":"border-gray-300"}`,children:r.concern_options.includes(s.value)&&e.jsx("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),e.jsx("span",{className:"text-sm font-medium",children:s.label})]},s.value))}),i.concern_options&&e.jsxs("p",{className:"mt-2 text-red-500 text-sm flex items-center",children:[e.jsx(o,{size:16,className:"mr-1"}),i.concern_options]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-gray-700 mb-2",children:"Product Description*"}),e.jsx("textarea",{name:"description",value:r.description,onChange:p,disabled:n,rows:"5",className:`w-full border ${i.description?"border-red-500":"border-gray-300"} rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-pink-500`,placeholder:"Write detailed information about your product..."}),i.description&&e.jsxs("p",{className:"mt-1 text-red-500 text-sm flex items-center",children:[e.jsx(o,{size:16,className:"mr-1"}),i.description]})]}),e.jsx("div",{className:"mt-8",children:e.jsx("button",{type:"button",onClick:I,disabled:n,className:`w-full ${n?"bg-pink-400 cursor-not-allowed":"bg-pink-500 hover:bg-pink-600"} text-white font-medium py-3 px-4 rounded-lg transition-colors flex items-center justify-center`,children:n?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Adding Product..."]}):"Add Product"})})]})]})})]})]})};export{J as default};
//# sourceMappingURL=AddProductPage-CbfTwGfN.js.map
